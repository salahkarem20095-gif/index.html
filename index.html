<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Legendary Tap Balls</title>
<style>
body { margin:0; overflow:hidden; background:#222; font-family:Arial; }
canvas { display:block; background:black; }
#scoreBox {
    position: fixed;
    top: 10px;
    left: 50%;
    transform: translateX(-50%);
    color:white;
    font-size: 20px;
    background: rgba(0,0,0,0.5);
    padding:5px 10px;
    border-radius:5px;
    z-index: 10;
}
</style>
</head>
<body>

<div id="scoreBox">
Score: <span id="score">0</span> |
Coins: <span id="coins">0</span> |
Lives: <span id="lives">3</span>
</div>

<canvas id="gameCanvas"></canvas>

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");

// ğŸŒ Ø¬Ø¹Ù„ Ø§Ù„ÙƒØ§Ù†ÙØ³ ÙŠÙ…Ù„Ø£ Ø§Ù„Ø´Ø§Ø´Ø©
function resizeCanvas(){
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
}
window.addEventListener('resize', resizeCanvas);
resizeCanvas();

// ================= Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ù„Ø¹Ø¨Ø© =================
let balls = [], score=0, coins=0, lives=3;
let initialBallCount = 5;

// ================= Ø£ØµÙˆØ§Øª Ø¨Ø³ÙŠØ·Ø© =================
function playSound(freq,duration=0.1){
    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    const osc = audioCtx.createOscillator();
    const gain = audioCtx.createGain();
    osc.connect(gain); gain.connect(audioCtx.destination);
    osc.frequency.value=freq;
    gain.gain.value=0.2;
    osc.start();
    osc.stop(audioCtx.currentTime + duration);
}
function soundClick(){ playSound(700,0.05); }
function soundBoom(){ playSound(60,0.5); }

// ================= Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ÙƒØ±Ø§Øª =================
function randomColor(){ let c=["red","green","blue","yellow","purple","orange"]; return c[Math.floor(Math.random()*c.length)]; }

function createBall(explosive=false){
    return {
        x: Math.random() * (canvas.width - 40) + 20,
        y: Math.random() * -200,
        r: 18,
        speed: 3,
        color: explosive ? "black" : randomColor(),
        explosive,
        flash: false,
        dx: Math.random()*2-1,
        alive: true
    };
}

function initBalls(){
    balls = [];
    for(let i=0;i<initialBallCount;i++) balls.push(createBall());
    balls.push(createBall(true)); // ÙƒØ±Ø© Ù…ØªÙØ¬Ø±Ø©
}

// ğŸ–Œï¸ ÙˆÙ…ÙŠØ¶ Ø§Ù„ÙƒØ±Ø© Ø§Ù„Ù…ØªÙØ¬Ø±Ø©
setInterval(()=>{
    balls.forEach(b=>{
        if(b.explosive){
            b.flash = !b.flash;
            b.color = b.flash ? "red" : "black";
        }
    });
},1000);

// ====== Ø±Ø³Ù… Ø§Ù„ÙƒØ±Ø§Øª ======
function draw(){
    ctx.clearRect(0,0,canvas.width,canvas.height);
    balls.forEach(b=>{
        ctx.beginPath();
        ctx.arc(b.x,b.y,b.r,0,Math.PI*2);
        ctx.fillStyle = b.color;
        ctx.fill();
    });
}

// ====== ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø­Ø±ÙƒØ© ======
function update(){
    balls.forEach(b=>{
        if(!b.alive) return;
        b.y += b.speed;
        b.x += b.dx * 1.5;

        if(b.x - b.r < 0 || b.x + b.r > canvas.width) b.dx *= -1;

        if(b.y - b.r > canvas.height){
            if(!b.explosive) score--;
            b.y = Math.random() * -200;
            b.x = Math.random() * (canvas.width - 40) + 20;
        }
    });
    draw();
    requestAnimationFrame(update);
}

// ====== Ø§Ù„Ù„Ù…Ø³ ÙˆØ§Ù„Ù…Ø§ÙˆØ³ ======
canvas.addEventListener("pointerdown", e=>{
    const rect = canvas.getBoundingClientRect();
    const mx = e.clientX - rect.left;
    const my = e.clientY - rect.top;

    balls.forEach(b=>{
        if(!b.alive) return;
        let dx = mx - b.x;
        let dy = my - b.y;
        if(dx*dx + dy*dy <= b.r*b.r){
            if(b.explosive){
                soundBoom();
                lives--;
                if(lives<0) lives=0;
                document.getElementById("lives").textContent = lives;
                if(lives<=0) alert("Game Over!"), resetGame();
            } else {
                soundClick();
                score++; coins++;
                document.getElementById("score").textContent = score;
                document.getElementById("coins").textContent = coins;
                b.alive = false; // Ø§Ù„ÙƒÙˆØ±Ø© ØªØ®ØªÙÙŠ
            }
        }
    });
});

// Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù„Ø¹Ø¨Ø©
function resetGame(){
    score=0; coins=0; lives=3;
    document.getElementById("score").textContent = score;
    document.getElementById("coins").textContent = coins;
    document.getElementById("lives").textContent = lives;
    initBalls();
}

// âœ… Ø¨Ø¯Ø¡ Ø§Ù„Ù„Ø¹Ø¨Ø©
initBalls();
update();

</script>
</body>
</html>
